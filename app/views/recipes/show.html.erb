<head>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=delete" />
</head>

<header class="flex items-center justify-between px-4 py-2 bg-white border-b">
  <div class="flex items-center">
    <span class="text-amber-500 text-xl font-bold">ğŸ´ NonFryer recipes</span>
  </div>
  <div class="flex items-center space-x-2">
    <% if logged_in? %>
      <%= render "shared/logout" %>
    <% else %>
      <%= render "shared/login" %>
    <% end %>
    <%= link_to "ï¼‹", new_recipe_path, class: "text-white bg-amber-500 rounded-full w-8 h-8 flex items-center justify-center" %>
  </div>
</header>

<body class="bg-white">
  <div class="flex items-center p-4 space-x-2">
    <%= render "shared/sidebar" %>
    <% if current_user && current_user.own?(@recipe) %>
      <%= link_to "ç·¨é›†", edit_recipe_path(@recipe), class: " border border-gray-300 rounded px-4 py-1" %>
      <%= link_to recipe_path(@recipe), data: { turbo_method: :delete, turbo_confirm: ('ãƒ¬ã‚·ãƒ”ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ') } do %>
        <span class="material-symbols-outlined border border-gray-300 rounded px-2 py-1">delete</span>
      <% end %>
    <% end %>
  </div>

  <% if @recipe.main_image.attached? %>
    <div class="overflow-hidden rounded mx-[20px]">
      <%= image_tag @recipe.main_image, class: "w-full h-[220px] object-cover" %>
    </div>
  <% end %>

  <div class="px-4 py-2 font-bold text-lg text-gray-600">
    <%= @recipe.title %>
  </div>

  <div class="grid grid-cols-2 gap-4 px-6 py-2">
    <div>
      <div class="font-bold text-gray-600">äºˆç†±</div>
      <div>
        <% if @recipe.preheat_temperature.present? && @recipe.preheat_time.present? %>
          <%= @recipe.preheat_temperature %> Â°C
          <%= @recipe.preheat_time %> åˆ†
        <% else %>
          ãªã—
        <% end %>
      </div>
    </div>
    <div>
      <div class="font-bold text-gray-600">èª¿ç†æ™‚é–“ãƒ»æ¸©åº¦</div>
      <div>
        <% @recipe.heats.each do |heat| %>
          <div>
            <%= heat.temperature %> Â°C
            <%= heat.time %> åˆ†
          </div>
        <% end %>
      </div>
    </div>
  </div>

  <div class="py-2">
    <div class="px-6 font-bold text-gray-600">æ©Ÿç¨®</div>
    <div class="px-6 py-1">
      <%= @recipe.model %>
    </div>
  </div>

  <div class="py-2">
    <div class="px-6 font-bold text-gray-600">ææ–™</div>
    <div class="px-6 py-1">
      <% @recipe.ingredients.each do |ingredient| %>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <%= ingredient.name %>
          </div>
          <div>
            <%= ingredient.quantity %>
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <div class="py-2">
    <div class="px-6 font-bold text-gray-600">ä½œã‚Šæ–¹</div>
    <div class="px-6 py-1">
      <% @recipe.instructions.each do |instruction| %>
        <div class="py-1">
          <%= instruction.step_number %>
          <%= instruction.description %>
          <% if instruction.image.attached? %>
            <%= image_tag instruction.image, class: "w-[160px] h-[100px] rounded w-[160px] h-[100px] object-cover" %>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>

  <div class="py-2">
    <div class="px-6 font-bold text-gray-600">ãƒã‚¤ãƒ³ãƒˆ</div>
    <div class="px-6 py-1">
      <%= @recipe.point %>
    </div>
  </div>

    <div class="py-2">
    <div class="px-6 font-bold text-gray-600">å‚è€ƒurl</div>
    <div class="px-6 py-1">
      <% @recipe.embeds.each do |embed| %>
        <% if embed.kind == "website" %>
          <%= link_to embed.safe_url, target: "_blank", rel: "noopener noreferrer", class: "block" do %>
            <div class="card">
              <p><%= embed.ogp_site_name.presence || "ã‚µã‚¤ãƒˆåãªã—" %></p>
              <% if embed.ogp_image_url.present? %>
                <img src="<%= embed.ogp_image_url %>" alt="OGP Image">
              <% end %>
              <p><%= embed.ogp_title.presence || "ã‚¿ã‚¤ãƒˆãƒ«ãªã—" %></p>
              <p><%= embed.ogp_description.presence || "è©³ç´°ãªã—" %></p>
            </div>
          <% end %>
        <% elsif embed.kind == "youtube" %>
          <%= content_tag 'iframe', nil, src: "https://www.youtube.com/embed/#{embed.embed_type}" %>
        <% elsif embed.kind == "instagram" %>
          <%= sanitize(embed.embed_type, tags: %w[blockquote a], attributes: %w[class data-instgrm-permalink data-instgrm-version href]) %>
          <script async src="https://www.instagram.com/embed.js"></script>
        <% end %>
      <% end %>
    </div>
  </div>

  <script>
    document.addEventListener("turbo:load", function() {
      if (window.instgrm) {
        instgrm.Embeds.process();
      }
    });
  </script>
</body>


